@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* ===========================
       NEW DESIGN TOKENS (Shadcn/Oklch)
       =========================== */
    --background: oklch(1 0 0);
    --foreground: oklch(0.145 0 0);
    --card: oklch(1 0 0);
    --card-foreground: oklch(0.145 0 0);
    --popover: oklch(1 0 0);
    --popover-foreground: oklch(0.145 0 0);
    --primary: oklch(0.205 0 0);
    --primary-foreground: oklch(0.985 0 0);
    --secondary: oklch(0.97 0 0);
    --secondary-foreground: oklch(0.205 0 0);
    --muted: oklch(0.97 0 0);
    --muted-foreground: oklch(0.556 0 0);
    --accent: oklch(0.97 0 0);
    --accent-foreground: oklch(0.205 0 0);
    --destructive: oklch(0.577 0.245 27.325);
    --destructive-foreground: oklch(0.577 0.245 27.325);
    --border: oklch(0.922 0 0);
    --input: oklch(0.922 0 0);
    --ring: oklch(0.708 0 0);
    --radius: 0.625rem;
    --chart-1: oklch(0.646 0.222 41.116);
    --chart-2: oklch(0.6 0.118 184.704);
    --chart-3: oklch(0.398 0.07 227.392);
    --chart-4: oklch(0.828 0.189 84.429);
    --chart-5: oklch(0.769 0.188 70.08);
    --sidebar: oklch(0.985 0 0);
    --sidebar-foreground: oklch(0.145 0 0);
    --sidebar-primary: oklch(0.205 0 0);
    --sidebar-primary-foreground: oklch(0.985 0 0);
    --sidebar-accent: oklch(0.97 0 0);
    --sidebar-accent-foreground: oklch(0.205 0 0);
    --sidebar-border: oklch(0.922 0 0);
    --sidebar-ring: oklch(0.708 0 0);

    /* ===========================
       LEGACY VARIABLE COMPATIBILITY LAYER
       Mapping old --nt vars to new tokens
       =========================== */
    --text-primary: var(--foreground);
    --text-secondary: var(--muted-foreground);
    --text-tertiary: var(--muted-foreground);
    /* Approx */

    --bg-primary: var(--background);
    --bg-secondary: var(--muted);
    /* Light gray usually */
    --bg-tertiary: var(--accent);
    --bg-elevated: var(--card);

    --border-subtle: var(--border);
    --border-default: var(--border);
    --border-strong: var(--input);
    /* bit darker */
    --border-primary: var(--input);
    --border-emphasis: var(--input);

    /* Semantic Colors */
    --color-primary-700: #047857;
    --color-primary-600: #059669;
    /* Keeping hardcoded for now to match safety green expectation */
    --color-primary-100: #D1FAE5;
    --color-primary-50: #ECFDF5;

    --color-danger-700: #b91c1c;
    --color-danger-600: var(--destructive);
    /* Red */
    --color-danger-100: #fee2e2;
    --color-danger-50: #FEF2F2;
    /* Light red */

    --color-slate-100: var(--muted);
    --color-slate-700: var(--foreground);

    --color-success-800: #065F46;
    --color-success-700: #059669;
    --color-success-600: #059669;
    --color-success-200: #A7F3D0;
    --color-success-100: #D1FAE5;
    --color-success-50: #ECFDF5;

    --color-warning-600: #D97706;
    --color-warning-50: #FFFBEB;

    /* Spacing */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.25rem;
    --space-6: 1.5rem;
    --space-7: 1.75rem;
    --space-8: 2rem;
    --space-10: 2.5rem;
    --space-12: 3rem;

    /* Radius */
    --radius-md: 0.375rem;
    --radius-lg: 0.5rem;
    --radius-xl: 0.75rem;
    --radius-full: 9999px;

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);

    /* Transitions */
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .dark {
    --background: oklch(0.145 0 0);
    --foreground: oklch(0.985 0 0);
    /* ... (rest of dark mode tokens) */
    --primary: oklch(0.985 0 0);
    --primary-foreground: oklch(0.205 0 0);
    /* Mapping legacy vars for dark mode if needed */
    --bg-secondary: oklch(0.269 0 0);
  }
}

* {
  @apply border-border;
  outline-color: hsl(var(--ring) / 0.5);
}

body {
  @apply bg-background text-foreground;
}

/* ===========================
   LEGACY CLASS COMPATIBILITY LAYER
   =========================== */
@layer components {

  /* Layout & Grid */
  .nt-grid-2 {
    @apply grid grid-cols-1 md:grid-cols-2 gap-4;
  }

  .nt-grid-3 {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6;
  }

  .nt-mb-8 {
    @apply mb-8;
  }

  /* App Shell */
  .nt-app-container {
    @apply min-h-screen bg-background text-foreground flex flex-col font-sans;
  }

  .nt-app-header {
    @apply sticky top-0 z-50 w-full border-b bg-background backdrop-blur flex items-center justify-between px-6 h-16 shadow-sm;
  }

  .nt-app-header__brand {
    @apply flex items-center gap-4;
  }

  .nt-app-org-badge {
    @apply px-2.5 py-0.5 rounded-md bg-muted text-muted-foreground text-xs font-medium border border-border;
  }

  .nt-app-header__actions {
    @apply flex items-center gap-4;
  }

  .nt-app-user-name {
    @apply text-sm font-medium text-muted-foreground;
  }

  .nt-mobile-menu-btn {
    @apply md:hidden flex items-center justify-center p-2 rounded-md hover:bg-muted text-foreground;
  }

  /* Sidebar */
  .nt-app-layout {
    @apply flex flex-1 h-[calc(100vh-64px)] overflow-hidden;
  }

  .nt-app-sidebar {
    @apply hidden md:flex flex-col w-[280px] bg-sidebar border-r border-sidebar-border overflow-y-auto p-4 gap-2;
  }

  .nt-app-sidebar--open {
    @apply flex fixed inset-y-0 left-0 z-50 w-64 bg-background border-r shadow-lg transform transition-transform duration-200 ease-in-out;
  }

  .nt-app-nav {
    @apply flex flex-col gap-1;
  }

  .nt-app-content {
    @apply flex-1 overflow-y-auto p-8 bg-background;
  }

  /* Nav Items */
  .nt-nav-item {
    @apply flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-md text-muted-foreground hover:bg-muted hover:text-foreground transition-all duration-200 outline-none w-full text-left;
  }

  .nt-nav-item--active {
    @apply bg-accent text-accent-foreground shadow-sm font-semibold;
  }

  .nt-nav-item svg {
    @apply size-4 shrink-0;
  }

  /* Stat Cards */
  .nt-stat-card {
    @apply bg-card text-card-foreground border border-border rounded-xl p-6 shadow-sm;
  }

  .nt-stat-card__value {
    @apply text-3xl font-bold text-foreground mb-1;
  }

  .nt-stat-card__label {
    @apply text-xs font-medium text-muted-foreground uppercase tracking-wide;
  }

  .nt-stat-card__icon {
    @apply flex items-center justify-center w-12 h-12 rounded-lg mb-4;
  }

  .nt-stat-card__icon--primary {
    @apply bg-green-50 text-green-600;
  }

  .nt-stat-card__icon--danger {
    @apply bg-red-50 text-red-600;
  }

  .nt-stat-card__value--danger {
    @apply text-red-600;
  }

  /* Generic Cards */
  .nt-card {
    @apply rounded-xl border bg-card text-card-foreground shadow-sm p-6 hover:shadow-md transition-shadow duration-200;
  }

  /* Empty States */
  .nt-empty-state {
    @apply flex flex-col items-center justify-center py-12 px-4 text-center border-2 border-dashed border-border rounded-xl bg-muted bg-opacity-30;
  }

  .nt-empty-state__icon {
    @apply size-16 text-muted-foreground opacity-50 mb-4;
  }

  .nt-empty-state__title {
    @apply text-lg font-semibold text-foreground mb-2;
  }

  .nt-empty-state__description {
    @apply text-sm text-muted-foreground max-w-sm mb-6;
  }

  /* Buttons */
  .nt-btn {
    @apply inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 py-2 px-4 h-10 cursor-pointer;
  }

  .nt-btn-primary {
    @apply bg-primary text-primary-foreground hover:opacity-90 shadow;
  }

  .nt-btn-secondary {
    @apply bg-secondary text-secondary-foreground hover:opacity-80 border border-input shadow-sm;
  }

  .nt-btn-danger {
    @apply bg-destructive text-destructive-foreground hover:opacity-90 shadow-sm;
  }

  .nt-btn-sm {
    @apply h-9 px-3 text-xs;
  }

  .nt-btn-lg {
    @apply h-11 px-8;
  }

  /* Forms */
  .nt-label {
    @apply block text-sm font-medium text-foreground mb-2;
  }

  .nt-input,
  .nt-select,
  .nt-textarea {
    @apply flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50;
  }

  .nt-textarea {
    @apply min-h-[80px];
  }

  /* Tables */
  .nt-table-container {
    @apply rounded-md border w-full overflow-hidden bg-card;
  }

  .nt-table {
    @apply w-full caption-bottom text-sm;
  }

  .nt-table thead {
    @apply [&_tr]:border-b bg-muted bg-opacity-50;
  }

  .nt-table tbody tr {
    @apply border-b transition-colors hover:bg-muted hover:bg-opacity-50 data-[state=selected]:bg-muted;
  }

  .nt-table th {
    @apply h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 uppercase text-xs tracking-wider;
  }

  .nt-table td {
    @apply p-4 align-middle [&:has([role=checkbox])]:pr-0 text-foreground;
  }

  /* Badges */
  .nt-badge {
    @apply inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2;
  }

  .nt-badge--success {
    @apply border-transparent bg-green-100 text-green-700 hover:bg-green-200;
  }

  .nt-badge--warning {
    @apply border-transparent bg-amber-100 text-amber-700 hover:bg-amber-200;
  }

  .nt-badge--danger {
    @apply border-transparent bg-red-100 text-red-700 hover:bg-red-200;
  }

  .nt-badge--inactive {
    @apply bg-secondary text-muted-foreground hover:opacity-80;
  }

  /* Utilities */
  .login-container {
    @apply min-h-screen flex items-center justify-center p-6 bg-background;
  }

  /* Spinner */
  .spinner {
    @apply inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-e-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite];
  }

  .spinner-sm {
    @apply h-4 w-4 border-2;
  }

  .spinner-white {
    @apply text-white;
  }

  /* Typing indicator for chat */
  .typing-indicator {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .typing-dot {
    width: 8px;
    height: 8px;
    background-color: var(--muted-foreground, #6b7280);
    border-radius: 50%;
    animation: typing-bounce 1.4s ease-in-out infinite;
  }

  .typing-dot:nth-child(1) {
    animation-delay: 0s;
  }

  .typing-dot:nth-child(2) {
    animation-delay: 0.2s;
  }

  .typing-dot:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes typing-bounce {
    0%, 60%, 100% {
      transform: translateY(0);
      opacity: 0.4;
    }
    30% {
      transform: translateY(-6px);
      opacity: 1;
    }
  }
}